<!-- Не забывайте про картинку-гайд -->
**Анимублядский WebM-тред**
для приличных анимублядей и прочих аутистов.
Безграмотное быдло с дубляжом, войсовером, порнографией, мокрыми письками, домашним видео с котиками и прочей ерундой, а также хэйтеры различных мастей отправляются в порнотред <ссылка>.
Аватаркобляди, неймфаги и прочие вниманиебляди отправляются на парашу для слабоумных.

Тред техподдержки (оп-пост устарел): https://2ch.hk/s/res/1035239.html
Если браузер вместо воспроизведения отдельных видео ругается на повреждённый видеофайл, либо не воспроизводит звук — он скорее всего не может в VP9 или Opus. См. http://en.wikipedia.org/wiki/HTML5_Audio#Supported_audio_codecs
Для поиска сoуса видео сохраняем кадр (правый клик по видео) и ищем его на http://images.google.com.

**О кодировании WebM**
Доступные кодеки — VP8 (libvpx, vp8) или VP9 (libvpx-vp9, vp9) для видео и Vorbis и Opus (libvorbis и libopus) для звука, **максимальный размер файла — 10240КБ**, всех файлов в посте — около 22МБ.

**Неочевидные моменты**
— libvorbis'у нельзя указывать фиксированный битрейт (-b:a) — это портит качество звука. Opus'у наоборот указывать битрейт необходимо;
— в webm'ки не стоит включать софтсаб в формате webvtt (ffmpeg это делает по умолчанию при наличии сабов в контейнере): во-первых, это бесполезно (для его отображения на странице должен быть специальный код), а во-вторых, от этого ролики не воспроизводятся в firefox;
— ролики с opus'ом в firefox зацикливаются не с начала, а с последнего ключевого кадра;
— mkvmerge упаковывает дорожки где-то на 1-2% эффективнее ffmpeg'а;
- порядок аргументов ffmpeg'а имеет значение, подробнее по ссылке ниже.

**Кодирование**
Быстро и просто, с удовлетворительным качеством и без подгонки по размеру:
 ffmpeg -i input.mkv -qmax 30 -sn out.webm
параметром qmax регулируется качество: чем меньше — тем лучше картинка и больше файл.
То же самое с современными кодеками (результат будет занимать в полтора-два раза меньше):
 ffmpeg -i input.mkv **-c:v vp9** -qmax 30 **-c:a libopus** -b:a 64k out.webm
Для получения максимального качества и подгонки по размеру нужно делать два прохода и считать битрейт, формула есть в пикчегайде.

**Обрезка по времени**
 ffmpeg **-ss начало** -i input.mkv **-t длительность** out.webm
 ffmpeg -i input.mkv **-ss начало** **-to конец** out.webm (дольше, т.к. файл будет декодироваться с начала, а не с нужной позиции)
время указывается либо числом секунд, либо в формате чч:мм:сс.

**Масштабирование**
 ffmpeg -i input.mkv **-vf scale=ширина:-1** out.webm

**Наложение субтитров**
 ffmpeg -i input.mkv **-vf subtitles=input.mkv** out.webm
 ffmpeg -i input.mkv **-vf ass=input.ass** out.webm
В параметрах фильтров (-vf) символы :, \, [, ], и , имеют специальное значение, их нужно экранировать установкой перед ними символа «\».
В ОС Windows данная операция требует настройки библиотеки fontconfig: https://github.com/pituz/webm-thread/wiki/fontconfig-on-windows
**Внимание:** параметр -ss ffmpeg'а следует указывать после входного файла, иначе тайминг субтитров будет считаться от начала фрагмента.

Ещё: https://github.com/pituz/webm-thread/wiki/ffmpeg

**Ссылки**
Основные понятия сжатия видео: https://github.com/pituz/webm-thread/wiki/glossary
Программы и их документация: http://webmproject.org http://ffmpeg.org http://mpv.io http://www.bunkus.org/videotools/mkvtoolnix/
Гуй с минимумом кнопок для ретардов (сперма-only): https://github.com/WebMBro/WebMConverter/releases
**Оп-паста**, исходники пикчегайда и оп-webm'а, скрипт пиления webm'ок на zsh: https://github.com/pituz/webm-thread/
